import struct

vm = struct.pack ("686B", *[
0x05,0x00,0x25,0x00,0x04,0x00,0x20,0x3a,0x01,0x00,0x05,
0x00,0x64,0x72,0x04,0x00,0x6f,0x77,0x01,0x00,0x05,0x00,
0x73,0x73,0x04,0x00,0x61,0x50,0x01,0x00,0x04,0x50,0x00,
0x88,0x12,0x50,0x03,0x06,0x04,0x10,0x00,0x0a,0x04,0x50,
0x00,0xa8,0x12,0x50,0x04,0x50,0x01,0x20,0x12,0x50,0x67,
0xc6,0x05,0x40,0xff,0xff,0x04,0x40,0xff,0xee,0x0d,0x20,
0x16,0x24,0x18,0x00,0x12,0x13,0x04,0x50,0x00,0x50,0x12,
0x50,0x69,0x73,0x0a,0x11,0x04,0x10,0x00,0x0a,0x05,0x00,
0x45,0x00,0x04,0x00,0x21,0x74,0x01,0x00,0x05,0x00,0x63,
0x65,0x04,0x00,0x72,0x72,0x01,0x00,0x05,0x00,0x6f,0x63,
0x04,0x00,0x6e,0x49,0x01,0x00,0x03,0x06,0x04,0x50,0x00,
0xa8,0x0a,0x44,0x12,0x50,0x14,0x00,0x21,0x00,0x00,0x00,
0x14,0x00,0x21,0x51,0x04,0x10,0x00,0x04,0x04,0x50,0x00,
0xa8,0x1d,0x18,0x00,0x26,0x13,0xff,0x4a,0xec,0x05,0x00,
0x21,0x72,0x04,0x00,0x72,0x45,0x01,0x00,0x03,0x06,0x12,
0x50,0x1f,0x29,0x01,0x20,0x00,0x00,0x16,0x14,0x18,0x00,
0x2d,0x02,0x20,0x13,0x06,0x20,0x1c,0x20,0x04,0x30,0x00,
0x01,0x08,0x03,0x09,0x13,0x14,0x00,0x2b,0xcd,0x0a,0x22,
0x01,0x00,0x01,0x10,0x04,0x50,0x00,0x88,0x12,0x50,0x04,
0x50,0x00,0x01,0x03,0x06,0x08,0x01,0x06,0x00,0x00,0x00,
0x16,0x04,0x18,0x00,0x3b,0x04,0x40,0x00,0x00,0x08,0x61,
0x08,0x61,0x13,0xba,0xab,0x1b,0x30,0x07,0x23,0x08,0x25,
0x09,0x05,0x14,0x00,0x37,0xf2,0x0a,0x11,0x04,0x10,0x00,
0x08,0x05,0x00,0x20,0x74,0x04,0x00,0x63,0x65,0x01,0x00,
0x05,0x00,0x72,0x72,0x04,0x00,0x6f,0x43,0x01,0x00,0x03,
0x06,0x04,0x50,0x00,0xa8,0x0a,0x44,0x12,0x50,0x1f,0xfb,
0xe3,0x46,0x04,0x00,0x00,0x11,0x04,0x50,0x00,0xc4,0x12,
0x50,0x04,0x30,0x00,0x02,0x04,0x50,0x00,0x38,0x12,0x50,
0x04,0x50,0x01,0x8c,0x12,0x50,0x18,0x00,0x61,0x04,0x50,
0x01,0xb0,0x12,0x50,0x18,0x00,0x61,0x04,0x50,0x01,0xcc,
0x12,0x50,0x18,0x00,0x61,0x04,0x50,0x02,0x0c,0x12,0x50,
0x18,0x00,0x61,0x04,0x50,0x02,0x34,0x12,0x50,0x18,0x00,
0x61,0x04,0x50,0x02,0x5c,0x12,0x50,0x18,0x00,0x61,0x04,
0x50,0x02,0x70,0x12,0x50,0x18,0x00,0x61,0x04,0x50,0x02,
0x88,0x12,0x50,0x18,0x00,0x61,0x04,0x50,0x00,0xf8,0x12,
0x50,0x7c,0xc2,0x04,0x50,0x00,0x50,0x12,0x50,0x54,0xf8,
0x04,0x50,0x00,0x88,0x12,0x50,0x06,0x40,0x0d,0x20,0x10,
0x42,0x05,0x10,0x3d,0x67,0x04,0x10,0x82,0xa5,0x0a,0x41,
0x05,0x10,0x5d,0xd5,0x04,0x10,0x3c,0x4f,0x16,0x14,0x13,
0x1b,0xe8,0xe7,0x08,0x03,0x06,0x40,0x05,0x10,0x23,0x25,
0x04,0x10,0xdb,0xf8,0x08,0x41,0x05,0x10,0x53,0x6d,0x04,
0x10,0x3b,0x6d,0x16,0x14,0x13,0x8d,0x76,0x5a,0x08,0x03,
0x06,0x40,0x0a,0x22,0x04,0x10,0x00,0x10,0x04,0x50,0x00,
0x54,0x0e,0x51,0x0c,0x25,0x04,0x10,0x00,0x00,0x04,0x50,
0x00,0x47,0x0e,0x51,0x0c,0x25,0x04,0x10,0x00,0x08,0x04,
0x50,0x00,0x30,0x0e,0x51,0x0c,0x25,0x04,0x10,0x00,0x18,
0x04,0x50,0x00,0x5f,0x0e,0x51,0x0c,0x25,0x09,0x42,0x0a,
0x22,0x16,0x24,0x11,0x51,0x13,0x2e,0x04,0x50,0xe2,0xbd,
0x08,0x03,0x06,0x40,0x05,0x50,0x20,0x59,0x0c,0x15,0x0a,
0x41,0x0a,0x55,0x04,0x50,0xbd,0xe9,0x09,0x45,0x04,0x50,
0x00,0x10,0x11,0x45,0x04,0x50,0x07,0x4c,0x09,0x45,0x16,
0x24,0x13,0x63,0x04,0x50,0x00,0x88,0x12,0x50,0x08,0x03,
0x06,0x40,0x04,0x50,0x00,0x13,0x11,0x45,0x05,0x10,0x38,
0x15,0x04,0x10,0xcf,0xb2,0x10,0x15,0x0a,0x41,0x05,0x10,
0x93,0x17,0x04,0x10,0xee,0xe5,0x16,0x14,0x13,0x33,0x08,
0x03,0x06,0x40,0x09,0x41,0x05,0x20,0xd4,0x19,0x04,0x20,
0x83,0x7a,0x16,0x24,0x13,0x9f,0xc9,0x9a,0x08,0x03,0x06,
0x40,0x08,0x12,0x09,0x14,0x11,0x10,0x05,0x40,0xb2,0xef,
0x04,0x40,0x2c,0x90,0x16,0x14,0x13,0x66,0x32,0x0d,0x08,
0x03,0x06,0x40,0x0a,0x40,0x0a,0x41,0x0a,0x42,0x0a,0x43,
0x05,0x20,0x66,0xd7,0x04,0x20,0xdb,0x8e,0x16,0x24,0x13,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00])
code = map(ord, vm)

op = {
    0x00: ("NOP"  , 0),
    0x01: ("PUSH" , 1),
    0x02: ("POP"  , 1),
    0x03: ("MOV"  , 2),
    0x04: ("MOVL" , 4),
    0x05: ("MOVH" , 4),
    0x06: ("MOVS1", 2),
    0x07: ("MOVS2", 2),
    0x08: ("ADD"  , 2),
    0x09: ("SUB"  , 2),
    0x0A: ("XOR"  , 2),
    0x0B: ("AND"  , 2),
    0x0C: ("OR"   , 2),
    0x0D: ("NOT"  , 1),
    0x0E: ("SHL"  , 2),
    0x0F: ("SHR"  , 2),
    0x10: ("ROL"  , 2),
    0x11: ("ROR"  , 2),
    0x12: ("CALL" , 1),
    0x13: ("RET"  , 0),
    0x14: ("JMP"  , 3),
    0x15: ("JMP"  , 1),
    0x16: ("CMP"  , 2),
    0x17: ("JZ"   , 3),
    0x18: ("JNZ"  , 3),
    0x19: ("JZ"   , 1),
    0x1A: ("JNZ"  , 1),
}

i = 0
while i < len(code):
    if code[i] in op:
        print "[%04x]" % i,
        print op[code[i]][0],
        j = 0
        c = op[code[i]][1]
        if c == 1:
            print " r%d" % (int(code[i+1])>>4)
            i += 2
        elif c == 2:
            print " r%d, r%d" % (int(code[i+1])>>4, int(code[i+1])&0xf)
            i += 2
        elif c == 3:
            n = "%04x" % ((int(code[i+1]<<8)+int(code[i+2]))*4)
            print "#"+n
            i += 3
        elif c == 4:
            n = "%04x" % ((int(code[i+2]<<8)+int(code[i+3])))
            print "r%d, " % (int(code[i+1])>>4),
            print "#"+n
            i += 4
        else:
            print
            i += 1
    else:
        print "[%04x]" % i,
        print "?! %02x" % code[i]
        i += 1
